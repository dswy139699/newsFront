(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a1beb8e"],{"280b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=this,a=t.$createElement,n=t._self._c||a;return n("page-header-wrapper",{scopedSlots:t._u([{key:"content",fn:function(){return[n("div",{staticClass:"page-header-content"})]},proxy:!0}])},[n("a-spin",{attrs:{tip:"Loading...",spinning:t.spinning}},[n("div",{staticClass:"content spin-content"},[n("div",[n("GlobalForm",{ref:"schoolSerch",attrs:{dataSource:t.getFormData,id:"schoolSearch"},scopedSlots:t._u([{key:"button",fn:function(){return[n("div",{staticStyle:{"margin-top":"4px","text-align":"right"}},[n("a-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v(" 查询 ")]),n("a-button",{staticStyle:{"margin-left":"10px"},on:{click:t.reset}},[t._v(" 重置 ")])],1)]},proxy:!0}])})],1),n("div",{staticStyle:{"text-align":"left"}},[n("a-button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:t.increase}},[t._v(" 新增 ")]),n("a-upload",{attrs:{showUploadList:!1,customRequest:t.customRequest},on:{change:function(){}}},[n("a-button",{attrs:{type:"primary"}},[t._v(" 导入班级信息 ")])],1)],1),n("div",{staticClass:"table",staticStyle:{"margin-top":"10px"}},[n("a-table",{attrs:{"row-selection":{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},columns:t.columns,"data-source":t.data,loading:t.loading,pagination:t.pagination,rowKey:function(e){return e.id}},on:{change:t.changePage},scopedSlots:t._u([{key:"action",fn:function(e,a){return n("span",{},[n("a",{on:{click:function(e){return t.onEdit(a)}}},[t._v("编辑")]),n("a-divider",{attrs:{type:"vertical"}}),n("a-popconfirm",{attrs:{title:"确定删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.delStu(a)}}},[n("a",[t._v("删除")])])],1)}}])},[t.data&&t.data.length>0?n("template",{slot:"footer"},[n("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.delStus(t.data)}}},[t._v("删除所选数据")])],1):t._e()],2)],1),n("div",{ref:"modal",staticClass:"modal"},[n("a-modal",{attrs:{title:t.title,visible:t.visible,destroyOnClose:"",getContainer:function(){return e.$refs.modal}},on:{cancel:t.cancel,ok:t.handelOk}},[n("div",{staticClass:"increase"},[n("GlobalForm",{ref:"increaseDom",attrs:{dataSource:t.getIncreaseForm,id:"increaseDom"},scopedSlots:t._u([{key:"warning",fn:function(){return[n("a-alert",{staticStyle:{margin:"5px 0 0 10px"},attrs:{message:"如：设计1班",type:"warning","show-icon":""}})]},proxy:!0},{key:"career",fn:function(){return[n("a-alert",{staticStyle:{margin:"5px 0 0 10px"},attrs:{message:"如：网络工程",type:"warning","show-icon":""}})]},proxy:!0},{key:"classNum",fn:function(){return[n("a-alert",{staticStyle:{margin:"5px 0 0 10px"},attrs:{message:"如：20111",type:"warning","show-icon":""}})]},proxy:!0},{key:"grade",fn:function(){return[n("a-alert",{staticStyle:{margin:"5px 0 0 10px"},attrs:{message:" 如：2011级",type:"warning","show-icon":""}})]},proxy:!0},{key:"classIds",fn:function(){return[n("div",[n("div",{staticClass:"table",staticStyle:{"margin-top":"10px"}},[n("a-table",{attrs:{"row-selection":{selectedRowKeys:t.selectedRowKeysIncrease,onChange:t.onSelectChangeIncrease},columns:t.columnsCourse,"data-source":t.$store.getters.courseNameList||[],loading:t.loadingCourse,pagination:{pageSize:5},rowKey:function(e){return e.id}}},[t.$store.getters.courseNameList&&t.$store.getters.courseNameList.length>0?n("template",{slot:"footer"},[n("div",[t._v(" 已选： "),t._l(t.selectedListInfo,(function(e){return n("span",{key:e.id,staticStyle:{margin:"0 5px 5px 0",display:"inline-block"}},[n("a-tag",{staticStyle:{"vertical-align":"top"},attrs:{color:"blue",closable:""},on:{close:function(a){return t.closeTag(a,e)}}},[t._v("("+t._s(e.num)+")"+t._s(e.name))])],1)}))],2)]):t._e()],2)],1)])]},proxy:!0}])})],1)])],1)])])],1)},o=[],i=(a("a434"),a("4795"),a("5530")),s=a("c0ad"),c=a("4360"),r={getFormData:function(e){var t=[{type:"input",label:"班级名称",col:"10",id:"clazzName",layout:{labelCol:"100px"}},{type:"input",label:"班级号",col:"10",id:"clazzNum",layout:{labelCol:"100px"}},{type:"children",col:"4",name:"button"}];return t},getIncreaseForm:function(e){var t=[{type:"input",label:"班级名称",col:"12",rules:[{required:!0,message:"班级名称不能为空"}],id:"clazzName",layout:{labelCol:"120px"}},{type:"children",col:"6",name:"warning"},{type:"input",label:"班级号",col:"12",rules:[{required:!0,message:"班级号不能为空"}],id:"clazzNum",layout:{labelCol:"120px"}},{type:"children",col:"6",name:"classNum"},{type:"input",label:"年级",col:"12",id:"grade",layout:{labelCol:"120px"}},{type:"children",col:"6",name:"grade"},{type:"input",label:"专业",col:"12",id:"major",layout:{labelCol:"120px"}},{type:"children",col:"6",name:"career"},{type:"input",label:"校区",col:"12",id:"campus",layout:{labelCol:"120px"}},{type:"select",label:"学校",options:c["a"].getters.schoolNameList||[],onChange:e.onChange,defaultValue:c["a"].getters.schoolNameList[0]?c["a"].getters.schoolNameList[0].value:"",col:"12",rules:[{required:!0,message:"学校不能为空"}],lineFeed:!0,id:"schoolId",layout:{labelCol:"120px"}},{type:"text",label:"所包含课程号",col:"24",lineFeed:!0,id:"clazzIds",name:"classIds",layout:{labelCol:"120px"}}];return t}},l=a("4bcd"),u=(a("d3b7"),a("b775")),d={getClazzForPage:"/clazz/getClazzForPage",getClazz:"/clazz/getClazz",delClazz:"/clazz/delClazz",saveClazz:"/clazz/saveClazz",getClazzById:"/clazz/getClazzById",updateClazz:"/clazz/updateClazz",importClazzInfo:"/import/importClazzInfo"};function p(e){return Object(u["b"])({url:d.getClazzForPage,method:"post",data:e})}function h(e){return Object(u["b"])({url:d.delClazz,method:"post",data:e})}function g(e){return Object(u["b"])({url:d.saveClazz,method:"post",data:e})}function f(e){return Object(u["b"])({url:d.updateClazz,method:"post",data:e})}function z(e){return Object(u["b"])({url:d.getClazzById,method:"post",data:e})}function m(e){return Object(u["b"])({url:d.importClazzInfo,method:"post",timeout:3e5,data:e})}var y={getClazzForPage:function(e){return new Promise((function(t,a){p(e).then((function(e){t(e||{})}))["catch"]((function(e){a(e)}))}))},delClazz:function(e){return new Promise((function(t,a){h(e).then((function(e){t(e)}))["catch"]((function(e){a(e)}))}))},saveClazz:function(e){return new Promise((function(t,a){g(e).then((function(e){t(e)}))["catch"]((function(e){a(e)}))}))},updateClazz:function(e){return new Promise((function(t,a){f(e).then((function(e){t(e)}))["catch"]((function(e){a(e)}))}))},getClazzById:function(e){return new Promise((function(t,a){z(e).then((function(e){t(e||{})}))["catch"]((function(e){a(e)}))}))},importClazzInfo:function(e){return new Promise((function(t,a){m(e).then((function(e){t(e)}))["catch"]((function(e){a(e)}))}))}},b=[{title:"班级名称",dataIndex:"clazzName",key:"clazzName"},{title:"班级号",dataIndex:"clazzNum",key:"clazzNum"},{title:"年级",dataIndex:"grade",key:"grade"},{title:"学院",dataIndex:"schoolName",key:"schoolName"},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],C=[{title:"课程号",dataIndex:"num",key:"num"},{title:"课程名称",dataIndex:"name",key:"name"}],I={name:"Index",components:{GlobalForm:s["a"]},data:function(){return{columns:b,spinning:!1,title:"新增课程",loading:!0,searchData:{},columnsCourse:C,courseData:[],loadingCourse:!1,selectedRowKeysIncrease:[],selectedListInfo:[],selectedRowKeys:[],editInfo:null,visible:!1,data:[],pagination:{current:1,pageSize:20,total:0}}},computed:{getFormData:function(){return r.getFormData(this)},getIncreaseForm:function(){return r.getIncreaseForm(this)}},created:function(){},mounted:function(){this.searchData={schoolId:this.$store.getters.selectSchoolInfo.value||""},this.$store.dispatch("GetCourse",{schoolId:this.searchData.schoolId}),this.getClazzForPage(Object(i["a"])({pageIndex:1,pageSize:this.pagination.pageSize},this.searchData))},methods:{onChange:function(e){this.$store.dispatch("GetCourse",{schoolId:e}),this.selectedRowKeysIncrease=[],this.selectedListInfo=[]},checkTel:function(e,t,a){if(t&&!Object(l["c"])(t)){var n="请输入正确格式的号码";a(n)}else a()},checkEma:function(e,t,a){if(t&&!Object(l["a"])(t)){var n="请输入正确格式的邮箱";a(n)}else a()},changePage:function(e){this.pagination.current=e.current,this.getClazzForPage(Object(i["a"])({pageIndex:e.current,pageSize:this.pagination.pageSize},this.searchData))},increase:function(){this.title="新增班级",this.visible=!0,this.$store.dispatch("GetCourse",{schoolId:this.$store.getters.schoolNameList[0]?this.$store.getters.schoolNameList[0].value:""}),this.editInfo=null},onEdit:function(e){var t=this;y.getClazzById({id:e.id}).then((function(e){var a=t._.cloneDeep(e),n=e.courseIds||[];t.$store.dispatch("GetCourse",{schoolId:a.schoolId}),t.title="编辑班级",t.editInfo=e,t.visible=!0,t.selectedRowKeysIncrease=[],t.selectedListInfo=n;for(var o=0;o<n.length;o++)t.selectedRowKeysIncrease.push(n[o].id);t.$nextTick((function(){setTimeout((function(){t.$refs.increaseDom.setFieldsValue(t._.pick(a,"clazzName","clazzNum","grade","major","campus","schoolId"))}))}))}))},handelOk:function(){var e=this.$refs.increaseDom.handleSubmit();e&&(this.editInfo?this.updateClazz(Object(i["a"])(Object(i["a"])(Object(i["a"])({},this.editInfo),e),{},{courseIds:this.selectedListInfo})):this.saveClazz(Object(i["a"])(Object(i["a"])({},e),{},{courseIds:this.selectedListInfo})),this.cancel())},cancel:function(){this.$refs.increaseDom.resetFields(),this.selectedRowKeysIncrease=[],this.selectedListInfo=[],this.visible=!1},search:function(){var e=this.$refs.schoolSerch.getFieldsValue();this.searchData=Object(i["a"])(Object(i["a"])({},e),{},{schoolId:this.$store.getters.selectSchoolInfo.value||""}),this.pagination.current=1,this.getClazzForPage(Object(i["a"])({pageIndex:1,pageSize:this.pagination.pageSize},this.searchData))},reset:function(){this.$refs.schoolSerch.resetFields()},onSelectChange:function(e){this.selectedRowKeys=e},onSelectChangeIncrease:function(e,t){this.selectedRowKeysIncrease=e,this.selectedListInfo=t},closeTag:function(e,t){for(var a=0;a<this.selectedRowKeysIncrease.length;a++)if(this.selectedRowKeysIncrease[a]===t.id){this.selectedRowKeysIncrease.splice(a,1);break}for(var n=0;n<this.selectedListInfo.length;n++)if(this.selectedListInfo[n].id===t.id){this.selectedListInfo.splice(n,1);break}},getClazzForPage:function(e){var t=this;this.loading=!0,y.getClazzForPage(e).then((function(e){t.data=e.records||[],t.pagination.total=e.total||0,t.loading=!1}))},saveClazz:function(e){var t=this;y.saveClazz(e).then((function(e){t.$notification.success({message:"新增成功"}),t.getClazzForPage(Object(i["a"])({pageIndex:t.pagination.current,pageSize:t.pagination.pageSize},t.searchData))}))},updateClazz:function(e){var t=this;y.updateClazz(e).then((function(e){t.$notification.success({message:"更新成功"}),t.getClazzForPage(Object(i["a"])({pageIndex:t.pagination.current,pageSize:t.pagination.pageSize},t.searchData))}))},delStu:function(e){this.delClazz({idList:[e.id]})},delStus:function(){this.delClazz({idList:this.selectedRowKeys})},delClazz:function(e){var t=this;y.delClazz(e).then((function(e){t.$notification.success({message:"删除成功"}),t.getClazzForPage(Object(i["a"])({pageIndex:t.pagination.current,pageSize:t.pagination.pageSize},t.searchData))}))},customRequest:function(e){var t=this,a=this.$store.getters.selectSchoolInfo||{};if(!a.value)return this.$notification.error({message:"学校信息不能为空",description:"请在右上角选择学校之后再上传"}),!0;this.spinning=!0;var n=new FormData;n.append("files",e.file),n.append("schoolId",a.value),n.append("importType",a.importType),y.importClazzInfo(n).then((function(e){t.$notification.success({message:"文件上传成功"}),t.spinning=!1,t.files=e}))["catch"]((function(){t.spinning=!1}))}}},v=I,x=(a("47d2"),a("2877")),S=Object(x["a"])(v,n,o,!1,null,"e918cad8",null);t["default"]=S.exports},"47d2":function(e,t,a){"use strict";a("9678")},"4bcd":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return i}));a("ac1f"),a("1276");function n(e){for(var t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],a=["1","0","X","9","8","7","6","5","4","3","2"],n=e+"",o=e[17],i=n.substring(0,17),s=i.split(""),c=s.length,r=0,l=0;l<c;l++)r+=s[l]*t[l];var u=r%11,d=a[u],p=/^[1-9][0-9]{5}([1][9][0-9]{2}|[2][0][0|1][0-9])([0][1-9]|[1][0|1|2])([0][1-9]|[1|2][0-9]|[3][0|1])[0-9]{3}([0-9]|[X])$/,h=p.test(e);return!(o!==d||!h)}function o(e){var t=/^0\d{2,3}-?\d{7,8}$/,a=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/;return!(!a.test(e)&&!t.test(e))}function i(e){var t=/^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\.)+(com|cn|net|org)$/;return!!t.test(e)}},9678:function(e,t,a){},a434:function(e,t,a){"use strict";var n=a("23e7"),o=a("23cb"),i=a("a691"),s=a("50c4"),c=a("7b0b"),r=a("65f0"),l=a("8418"),u=a("1dde"),d=a("ae40"),p=u("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),g=Math.max,f=Math.min,z=9007199254740991,m="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!p||!h},{splice:function(e,t){var a,n,u,d,p,h,y=c(this),b=s(y.length),C=o(e,b),I=arguments.length;if(0===I?a=n=0:1===I?(a=0,n=b-C):(a=I-2,n=f(g(i(t),0),b-C)),b+a-n>z)throw TypeError(m);for(u=r(y,n),d=0;d<n;d++)p=C+d,p in y&&l(u,d,y[p]);if(u.length=n,a<n){for(d=C;d<b-n;d++)p=d+n,h=d+a,p in y?y[h]=y[p]:delete y[h];for(d=b;d>b-n+a;d--)delete y[d-1]}else if(a>n)for(d=b-n;d>C;d--)p=d+n-1,h=d+a-1,p in y?y[h]=y[p]:delete y[h];for(d=0;d<a;d++)y[d+C]=arguments[d+2];return y.length=b-n+a,u}})}}]);