(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9ec10c9a"],{"4bcd":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}));n("ac1f"),n("1276");function a(e){for(var t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],n=["1","0","X","9","8","7","6","5","4","3","2"],a=e+"",o=e[17],i=a.substring(0,17),s=i.split(""),c=s.length,r=0,l=0;l<c;l++)r+=s[l]*t[l];var u=r%11,d=n[u],h=/^[1-9][0-9]{5}([1][9][0-9]{2}|[2][0][0|1][0-9])([0][1-9]|[1][0|1|2])([0][1-9]|[1|2][0-9]|[3][0|1])[0-9]{3}([0-9]|[X])$/,p=h.test(e);return!(o!==d||!p)}function o(e){var t=/^0\d{2,3}-?\d{7,8}$/,n=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/;return!(!n.test(e)&&!t.test(e))}function i(e){var t=/^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\.)+(com|cn|net|org)$/;return!!t.test(e)}},"719b":function(e,t,n){"use strict";n("f661")},a434:function(e,t,n){"use strict";var a=n("23e7"),o=n("23cb"),i=n("a691"),s=n("50c4"),c=n("7b0b"),r=n("65f0"),l=n("8418"),u=n("1dde"),d=n("ae40"),h=u("splice"),p=d("splice",{ACCESSORS:!0,0:0,1:2}),g=Math.max,f=Math.min,m=9007199254740991,y="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!h||!p},{splice:function(e,t){var n,a,u,d,h,p,b=c(this),v=s(b.length),C=o(e,v),I=arguments.length;if(0===I?n=a=0:1===I?(n=0,a=v-C):(n=I-2,a=f(g(i(t),0),v-C)),v+n-a>m)throw TypeError(y);for(u=r(b,a),d=0;d<a;d++)h=C+d,h in b&&l(u,d,b[h]);if(u.length=a,n<a){for(d=C;d<v-a;d++)h=d+a,p=d+n,h in b?b[p]=b[h]:delete b[p];for(d=v;d>v-a+n;d--)delete b[d-1]}else if(n>a)for(d=v-a;d>C;d--)h=d+a-1,p=d+n-1,h in b?b[p]=b[h]:delete b[p];for(d=0;d<n;d++)b[d+C]=arguments[d+2];return b.length=v-a+n,u}})},e4dc3:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=this,n=t.$createElement,a=t._self._c||n;return a("page-header-wrapper",{scopedSlots:t._u([{key:"content",fn:function(){return[a("div",{staticClass:"page-header-content"})]},proxy:!0}])},[a("a-spin",{attrs:{tip:"Loading...",spinning:t.spinning}},[a("div",{staticClass:"content spin-content"},[a("div",[a("GlobalForm",{ref:"schoolSerch",attrs:{dataSource:t.getFormData,id:"schoolSearch"},scopedSlots:t._u([{key:"button",fn:function(){return[a("div",{staticStyle:{"margin-top":"4px","text-align":"right"}},[a("a-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v(" 查询 ")]),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:t.reset}},[t._v(" 重置 ")])],1)]},proxy:!0}])})],1),a("div",{staticStyle:{"text-align":"left"}},[a("a-button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:t.increase}},[t._v(" 新增 ")]),a("a-upload",{attrs:{showUploadList:!1,customRequest:t.customRequest},on:{change:function(){}}},[a("a-button",{attrs:{type:"primary"}},[t._v(" 导入课程信息 ")])],1)],1),a("div",{staticClass:"table",staticStyle:{"margin-top":"10px"}},[a("a-table",{attrs:{"row-selection":{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},columns:t.columns,"data-source":t.data,loading:t.loading,pagination:t.pagination,rowKey:function(e){return e.id}},on:{change:t.changePage},scopedSlots:t._u([{key:"action",fn:function(e,n){return a("span",{},[a("a",{on:{click:function(e){return t.onEdit(n)}}},[t._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"确定删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.delStu(n)}}},[a("a",[t._v("删除")])])],1)}}])},[t.data&&t.data.length>0?a("template",{slot:"footer"},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.delStus(t.data)}}},[t._v("删除所选数据")])],1):t._e()],2)],1),a("div",{ref:"modal",staticClass:"modal"},[a("a-modal",{attrs:{title:t.title,visible:t.visible,destroyOnClose:"",getContainer:function(){return e.$refs.modal}},on:{cancel:t.cancel,ok:t.handelOk}},[a("div",{staticClass:"increase"},[a("GlobalForm",{ref:"increaseDom",attrs:{dataSource:t.getIncreaseForm,id:"increaseDom"},scopedSlots:t._u([{key:"warning",fn:function(){return[a("a-alert",{staticStyle:{margin:"5px 0 0 10px"},attrs:{message:"课程号必须唯一",type:"warning","show-icon":""}})]},proxy:!0},{key:"telPhone",fn:function(){return[a("a-alert",{staticStyle:{margin:"5px 0 0 10px"},attrs:{message:"如：0755-1234567",type:"warning","show-icon":""}})]},proxy:!0},{key:"password",fn:function(){return[a("a-alert",{staticStyle:{margin:"5px 0 0 10px"},attrs:{message:"密码必须六位以上",type:"warning","show-icon":""}})]},proxy:!0},{key:"books",fn:function(){return[a("div",[a("div",{staticClass:"table",staticStyle:{"margin-top":"10px"}},[a("a-table",{attrs:{"row-selection":{selectedRowKeys:t.selectedRowKeysIncrease,onChange:t.onSelectChangeIncrease},columns:t.columnsCourse,"data-source":t.$store.getters.bookNameList||[],loading:t.loadingCourse,pagination:{pageSize:5},rowKey:function(e){return e.id}}},[t.$store.getters.bookNameList&&t.$store.getters.bookNameList.length>0?a("template",{slot:"footer"},[a("div",[t._v(" 已选： "),t._l(t.selectedListInfo,(function(e){return a("span",{key:e.id,staticStyle:{margin:"0 5px 5px 0",display:"inline-block"}},[a("a-tag",{staticStyle:{"vertical-align":"top"},attrs:{color:"blue",closable:""},on:{close:function(n){return t.closeTag(n,e)}}},[t._v("("+t._s(e.id)+")"+t._s(e.name))])],1)}))],2)]):t._e()],2)],1)])]},proxy:!0}])})],1)])],1)])])],1)},o=[],i=(n("a434"),n("4795"),n("5530")),s=n("c0ad"),c=n("4360"),r={getFormData:function(e){var t=[{type:"input",label:"课程名称",col:"10",id:"name",layout:{labelCol:"100px"}},{type:"children",col:"4",name:"button"}];return t},getIncreaseForm:function(e){var t=[{type:"input",label:"课程号",rules:[{required:!0,message:"课程号不能为空"}],col:"12",id:"num",layout:{labelCol:"120px"}},{type:"children",col:"6",name:"warning"},{type:"input",label:"课程负责人",col:"12",id:"chargePerson",layout:{labelCol:"120px"}},{type:"input",label:"老师工号",col:"12",id:"jobNumber",layout:{labelCol:"120px"}},{type:"input",label:"课程名",col:"12",rules:[{required:!0,message:"课程名不能为空"}],id:"name",layout:{labelCol:"120px"}},{type:"input",label:"课程代码",col:"12",rules:[{required:!0,message:"课程代码不能为空"}],id:"code",layout:{labelCol:"120px"}},{type:"select",label:"开课学校",options:c["a"].getters.schoolNameList||[],defaultValue:c["a"].getters.schoolNameList[0]?c["a"].getters.schoolNameList[0].value:"",col:"12",onChange:e.onChange,rules:[{required:!0,message:"开课学校不能为空"}],id:"collegeId",layout:{labelCol:"120px"}},{type:"input",label:"办公地点",col:"12",id:"officeLocation",layout:{labelCol:"120px"}},{type:"input",label:"邮箱",col:"12",id:"email",rules:[{validator:e.checkEma}],layout:{labelCol:"120px"}},{type:"input",label:"教参收货地址",col:"12",id:"recieveLocation",layout:{labelCol:"120px"}},{type:"input",label:"联系电话",col:"12",id:"telphone",rules:[{validator:e.checkTel}],layout:{labelCol:"120px"}},{type:"children",col:"6",name:"telPhone"},{type:"input",label:"收货电话",col:"12",id:"recieveTel",rules:[{validator:e.checkTel}],layout:{labelCol:"120px"}},{type:"children",col:"6",name:"telPhone"},{type:"text",label:"教材",col:"24",id:"books",name:"books",layout:{labelCol:"120px"}}];return t}},l=n("4bcd"),u=(n("d3b7"),n("cabd")),d={getCourseForPage:function(e){return new Promise((function(t,n){Object(u["d"])(e).then((function(e){t(e||{})}))["catch"]((function(e){n(e)}))}))},delCourse:function(e){return new Promise((function(t,n){Object(u["a"])(e).then((function(e){t(e)}))["catch"]((function(e){n(e)}))}))},saveCourse:function(e){return new Promise((function(t,n){Object(u["f"])(e).then((function(e){t(e)}))["catch"]((function(e){n(e)}))}))},updateCourse:function(e){return new Promise((function(t,n){Object(u["g"])(e).then((function(e){t(e)}))["catch"]((function(e){n(e)}))}))},getCourseById:function(e){return new Promise((function(t,n){Object(u["c"])(e).then((function(e){t(e||{})}))["catch"]((function(e){n(e)}))}))},importCourseInfo:function(e){return new Promise((function(t,n){Object(u["e"])(e).then((function(e){t(e)}))["catch"]((function(e){n(e)}))}))}},h=[{title:"课程号",dataIndex:"num",key:"num"},{title:"课程名",dataIndex:"name",key:"name"},{title:"课程代码",dataIndex:"code",key:"code"},{title:"所属学校",dataIndex:"schoolName",key:"schoolName"},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],p=[{title:"出版社",dataIndex:"press",key:"press"},{title:"教材名",dataIndex:"name",key:"name"}],g={name:"Index",components:{GlobalForm:s["a"]},data:function(){return{columns:h,columnsCourse:p,title:"新增课程",loading:!0,spinning:!1,url:"http://106.13.112.221:9089",loadingCourse:!1,selectedRowKeysIncrease:[],selectedListInfo:[],searchData:{},selectedRowKeys:[],editInfo:null,visible:!1,data:[],pagination:{current:1,pageSize:20,total:0}}},computed:{getFormData:function(){return r.getFormData(this)},getIncreaseForm:function(){return r.getIncreaseForm(this)}},created:function(){},mounted:function(){this.searchData={schoolId:this.$store.getters.selectSchoolInfo.value||""},this.$store.dispatch("GetTeachingMaterial",{schoolId:this.searchData.schoolId}),this.getCourseForPage(Object(i["a"])({pageIndex:1,pageSize:this.pagination.pageSize},this.searchData))},methods:{onChange:function(e){this.$store.dispatch("GetTeachingMaterial",{schoolId:e}),this.selectedRowKeysIncrease=[],this.selectedListInfo=[]},checkTel:function(e,t,n){if(t&&!Object(l["c"])(t)){var a="请输入正确格式的号码";n(a)}else n()},checkEma:function(e,t,n){if(t&&!Object(l["a"])(t)){var a="请输入正确格式的邮箱";n(a)}else n()},changePage:function(e){this.pagination.current=e.current,this.getCourseForPage(Object(i["a"])({pageIndex:e.current,pageSize:this.pagination.pageSize},this.searchData))},increase:function(){this.title="新增课程",this.$store.dispatch("GetTeachingMaterial",{schoolId:this.$store.getters.schoolNameList[0]?this.$store.getters.schoolNameList[0].value:""}),this.visible=!0,this.editInfo=null},onEdit:function(e){var t=this;d.getCourseById({id:e.id}).then((function(e){var n=t._.cloneDeep(e);t.title="编辑课程",t.editInfo=e,t.$store.dispatch("GetTeachingMaterial",{schoolId:n.collegeId}),t.visible=!0;var a=n.teachingMaterialIds||[];t.selectedRowKeysIncrease=[],t.selectedListInfo=a;for(var o=0;o<a.length;o++)t.selectedRowKeysIncrease.push(a[o].id);t.$nextTick((function(){setTimeout((function(){t.$refs.increaseDom.setFieldsValue(t._.pick(n,"num","chargePerson","jobNumber","name","code","collegeId","officeLocation","email","recieveLocation","telphone","recieveTel"))}))}))}))},handelOk:function(){var e=this.$refs.increaseDom.handleSubmit();e.teachingMaterialIds=this.selectedListInfo,e&&(this.editInfo?this.updateCourse(Object(i["a"])(Object(i["a"])({},this.editInfo),e)):this.saveCourse(e),this.cancel())},cancel:function(){this.$refs.increaseDom.resetFields(),this.visible=!1},search:function(){var e=this.$refs.schoolSerch.getFieldsValue();this.pagination.current=1,this.searchData=Object(i["a"])(Object(i["a"])({},e),{},{schoolId:this.$store.getters.selectSchoolInfo.value||""}),this.getCourseForPage(Object(i["a"])({pageIndex:1,pageSize:this.pagination.pageSize},this.searchData))},reset:function(){this.$refs.schoolSerch.resetFields()},onSelectChange:function(e){this.selectedRowKeys=e},closeTag:function(e,t){for(var n=0;n<this.selectedRowKeysIncrease.length;n++)if(this.selectedRowKeysIncrease[n]===t.id){this.selectedRowKeysIncrease.splice(n,1);break}for(var a=0;a<this.selectedListInfo.length;a++)if(this.selectedListInfo[a].id===t.id){this.selectedListInfo.splice(a,1);break}},getCourseForPage:function(e){var t=this;this.loading=!0,d.getCourseForPage(e).then((function(e){t.data=e.records||[],t.pagination.total=e.total||0,t.loading=!1}))},onSelectChangeIncrease:function(e,t){this.selectedRowKeysIncrease=e,this.selectedListInfo=t},saveCourse:function(e){var t=this;d.saveCourse(e).then((function(e){t.$notification.success({message:"新增成功"}),t.$store.dispatch("GetCourse"),t.getCourseForPage(Object(i["a"])({pageIndex:t.pagination.current,pageSize:t.pagination.pageSize},t.searchData))}))},updateCourse:function(e){var t=this;d.updateCourse(e).then((function(e){t.$notification.success({message:"更新成功"}),t.$store.dispatch("GetCourse"),t.getCourseForPage(Object(i["a"])({pageIndex:t.pagination.current,pageSize:t.pagination.pageSize},t.searchData))}))},delStu:function(e){this.delCourse({idList:[e.id]})},delStus:function(){this.delCourse({idList:this.selectedRowKeys})},delCourse:function(e){var t=this;d.delCourse(e).then((function(e){t.$notification.success({message:"删除成功"}),t.$store.dispatch("GetCourse"),t.getCourseForPage(Object(i["a"])({pageIndex:t.pagination.current,pageSize:t.pagination.pageSize},t.searchData))}))},customRequest:function(e){var t=this,n=this.$store.getters.selectSchoolInfo||{};if(!n.value)return this.$notification.error({message:"学校信息不能为空",description:"请在右上角选择学校之后再上传"}),!0;this.spinning=!0;var a=new FormData;a.append("files",e.file),a.append("schoolId",n.value),a.append("importType",n.importType),d.importCourseInfo(a).then((function(e){t.$notification.success({message:"文件上传成功"}),t.spinning=!1,t.files=e}))["catch"]((function(){t.spinning=!1}))}}},f=g,m=(n("719b"),n("2877")),y=Object(m["a"])(f,a,o,!1,null,"5b766ee3",null);t["default"]=y.exports},f661:function(e,t,n){}}]);