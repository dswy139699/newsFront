{"remainingRequest":"/Users/yushengnan/bysj/ysn/node_modules/babel-loader/lib/index.js!/Users/yushengnan/bysj/ysn/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yushengnan/bysj/ysn/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yushengnan/bysj/ysn/src/views/user/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yushengnan/bysj/ysn/src/views/user/Login.vue","mtime":1650686356997},{"path":"/Users/yushengnan/bysj/ysn/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yushengnan/bysj/ysn/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yushengnan/bysj/ysn/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yushengnan/bysj/ysn/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi50aW1lcnMiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvVXNlcnMveXVzaGVuZ25hbi9ieXNqL3lzbi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IG1hcEFjdGlvbnMgfSBmcm9tICd2dWV4JzsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHt9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjdXN0b21BY3RpdmVLZXk6ICd0YWIxJywKICAgICAgbG9naW5CdG46IGZhbHNlLAogICAgICBsb2dpblR5cGU6IDAsCiAgICAgIGlzTG9naW5FcnJvcjogZmFsc2UsCiAgICAgIHJlcXVpcmVkVHdvU3RlcENhcHRjaGE6IGZhbHNlLAogICAgICBzdGVwQ2FwdGNoYVZpc2libGU6IGZhbHNlLAogICAgICBmb3JtOiB0aGlzLiRmb3JtLmNyZWF0ZUZvcm0odGhpcyksCiAgICAgIHN0YXRlOiB7CiAgICAgICAgdGltZTogNjAsCiAgICAgICAgbG9naW5CdG46IGZhbHNlLAogICAgICAgIGxvZ2luVHlwZTogMCwKICAgICAgICBzbXNTZW5kQnRuOiBmYWxzZQogICAgICB9CiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHt9LAogIG1ldGhvZHM6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbWFwQWN0aW9ucyhbJ0xvZ2luJywgJ0xvZ291dCcsICdHZXRTY2hvb2wnLCAnR2V0Q2xhc3MnXSkpLCB7fSwgewogICAgaGFuZGxlU3VibWl0OiBmdW5jdGlvbiBoYW5kbGVTdWJtaXQoZSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB2YXIgdmFsaWRhdGVGaWVsZHMgPSB0aGlzLmZvcm0udmFsaWRhdGVGaWVsZHMsCiAgICAgICAgICBzdGF0ZSA9IHRoaXMuc3RhdGUsCiAgICAgICAgICBMb2dpbiA9IHRoaXMuTG9naW47CiAgICAgIHN0YXRlLmxvZ2luQnRuID0gdHJ1ZTsKICAgICAgdmFsaWRhdGVGaWVsZHMoZnVuY3Rpb24gKGVyciwgdmFsdWVzKSB7CiAgICAgICAgaWYgKCFlcnIpIHsKICAgICAgICAgIHZhciBkYXRhID0gX29iamVjdFNwcmVhZCh7fSwgdmFsdWVzKTsKCiAgICAgICAgICBMb2dpbihkYXRhKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvZ2luU3VjY2VzcyhyZXMpOwogICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICByZXR1cm4gX3RoaXMucmVxdWVzdEZhaWxlZChlcnIpOwogICAgICAgICAgfSlbImZpbmFsbHkiXShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHN0YXRlLmxvZ2luQnRuID0gZmFsc2U7CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHN0YXRlLmxvZ2luQnRuID0gZmFsc2U7CiAgICAgICAgICB9LCA2MDApOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgbG9naW5TdWNjZXNzOiBmdW5jdGlvbiBsb2dpblN1Y2Nlc3MocmVzKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgLy8gdGhpcy5HZXRTY2hvb2woKS50aGVuKCkuY2F0Y2goKS5maW5hbGx5KHJlc3BvbnNlID0+IHsKICAgICAgLy8gdGhpcy5HZXRDbGFzcygpLnRoZW4oKQogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnR2VuZXJhdGVSb3V0ZXMnLCB7CiAgICAgICAgcm9sZXM6IFtdLAogICAgICAgIHVzZXI6IHJlcy51c2VyIHx8IHt9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIC8vIOWGmeatu+inkuiJsu+8jOWunumZheW6lOivpeagueaNruWQjuWPsOS8oOi/h+adpeeahOinkuiJsuS/oeaBrwogICAgICAgIC8vICAgLy8g5qC55o2ucm9sZXPmnYPpmZDnlJ/miJDlj6/orr/pl67nmoTot6/nlLHooagKICAgICAgICAvLyAgIC8vIOWKqOaAgea3u+WKoOWPr+iuv+mXrui3r+eUseihqAogICAgICAgIF90aGlzMi4kcm91dGVyLmFkZFJvdXRlcyhfdGhpczIuJHN0b3JlLmdldHRlcnMuYWRkUm91dGVycyk7CgogICAgICAgIGNvbnNvbGUubG9nKF90aGlzMi4kc3RvcmUuZ2V0dGVycy5hZGRSb3V0ZXJzKTsgLy8gaWYgKHJlcyAmJiByZXMudXNlciAmJiByZXMudXNlci51c2VyVHlwZSAmJiByZXMudXNlci51c2VyVHlwZSA9PT0gJ3NjaG9vbCcpIHsKCiAgICAgICAgX3RoaXMyLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICBwYXRoOiBfdGhpczIuJHJvdXRlLnF1ZXJ5LnJlZGlyZWN0IHx8ICcvJwogICAgICAgIH0pOyAvLyB9IGVsc2UgaWYgKHJlcyAmJiByZXMudXNlciAmJiByZXMudXNlci51c2VyVHlwZSAmJiByZXMudXNlci51c2VyVHlwZSA9PT0gJ3N0dWRlbnQnKSB7CiAgICAgICAgLy8gICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6ICcvYm9vay9zdHVkZW50L3VuUGF5ZWQnIH0pCiAgICAgICAgLy8gfQoKICAgICAgfSk7IC8vIH0pCgogICAgICB0aGlzLmlzTG9naW5FcnJvciA9IGZhbHNlOwogICAgfSwKICAgIHJlcXVlc3RGYWlsZWQ6IGZ1bmN0aW9uIHJlcXVlc3RGYWlsZWQoZXJyKSB7CiAgICAgIHRoaXMuaXNMb2dpbkVycm9yID0gdHJ1ZTsKICAgICAgdGhpcy4kbm90aWZpY2F0aW9uWydlcnJvciddKHsKICAgICAgICBtZXNzYWdlOiAn6ZSZ6K+vJywKICAgICAgICBkZXNjcmlwdGlvbjogKChlcnIucmVzcG9uc2UgfHwge30pLmRhdGEgfHwge30pLm1lc3NhZ2UgfHwgJ+ivt+axguWHuueOsOmUmeivr++8jOivt+eojeWQjuWGjeivlScsCiAgICAgICAgZHVyYXRpb246IDQKICAgICAgfSk7CiAgICB9CiAgfSkKfTs="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"main\">\n    <a-form\n      id=\"formLogin\"\n      class=\"user-layout-login\"\n      ref=\"formLogin\"\n      :form=\"form\"\n      :label-col=\"{ span: 5 }\"\n      :wrapper-col=\"{ span: 19 }\"\n      @submit=\"handleSubmit\"\n    >\n      <div style=\"margin-top:70px;\">\n        <a-alert v-if=\"isLoginError\" type=\"error\" showIcon style=\"margin-bottom: 24px;\" message=\"账户或密码错误\" />\n        <a-form-item label=\"用户名\">\n          <a-input\n            size=\"large\"\n            type=\"text\"\n            placeholder=\"请输入用户名\"\n            v-decorator=\"[\n              'loginId',\n              {rules: [{ required: true, message: '请输入用户名' }]}\n            ]\"\n          >\n            <a-icon slot=\"prefix\" type=\"user\" :style=\"{ color: 'rgba(0,0,0,.25)' }\"/>\n          </a-input>\n        </a-form-item>\n\n        <a-form-item label=\"密码\">\n          <a-input-password\n            size=\"large\"\n            placeholder=\"请输入密码\"\n            v-decorator=\"[\n              'loginPwd',\n              {rules: [{ required: true, message: '请输入密码' }]}\n            ]\"\n          >\n            <a-icon slot=\"prefix\" type=\"lock\" :style=\"{ color: 'rgba(0,0,0,.25)' }\"/>\n          </a-input-password>\n        </a-form-item>\n      </div>\n      <a-form-item style=\"margin-top:24px\" :wrapper-col=\"{ span: 19, offset: 5 }\" >\n        <a-button\n          size=\"large\"\n          type=\"primary\"\n          htmlType=\"submit\"\n          class=\"login-button\"\n          :loading=\"state.loginBtn\"\n          :disabled=\"state.loginBtn\"\n        >确定</a-button>\n      </a-form-item>\n    </a-form>\n  </div>\n</template>\n\n<script>\nimport { mapActions } from 'vuex'\n\nexport default {\n  components: {\n  },\n  data () {\n    return {\n      customActiveKey: 'tab1',\n      loginBtn: false,\n      loginType: 0,\n      isLoginError: false,\n      requiredTwoStepCaptcha: false,\n      stepCaptchaVisible: false,\n      form: this.$form.createForm(this),\n      state: {\n        time: 60,\n        loginBtn: false,\n        loginType: 0,\n        smsSendBtn: false\n      }\n    }\n  },\n  created () {\n\n  },\n  methods: {\n    ...mapActions(['Login', 'Logout', 'GetSchool', 'GetClass']),\n    handleSubmit (e) {\n      e.preventDefault()\n      const {\n        form: { validateFields },\n        state,\n        Login\n      } = this\n\n      state.loginBtn = true\n      validateFields((err, values) => {\n        if (!err) {\n          const data = { ...values }\n          Login(data)\n            .then((res) => this.loginSuccess(res))\n            .catch(err => this.requestFailed(err))\n            .finally(() => {\n              state.loginBtn = false\n            })\n        } else {\n          setTimeout(() => {\n            state.loginBtn = false\n          }, 600)\n        }\n      })\n    },\n    loginSuccess (res) {\n      // this.GetSchool().then().catch().finally(response => {\n      // this.GetClass().then()\n      this.$store.dispatch('GenerateRoutes', { roles: [], user: res.user || {} }).then(() => { // 写死角色，实际应该根据后台传过来的角色信息\n      //   // 根据roles权限生成可访问的路由表\n      //   // 动态添加可访问路由表\n        this.$router.addRoutes(this.$store.getters.addRouters)\n        console.log(this.$store.getters.addRouters)\n      // if (res && res.user && res.user.userType && res.user.userType === 'school') {\n        this.$router.push({ path: this.$route.query.redirect || '/' })\n      // } else if (res && res.user && res.user.userType && res.user.userType === 'student') {\n      //   this.$router.push({ path: '/book/student/unPayed' })\n      // }\n      })\n      // })\n      this.isLoginError = false\n    },\n    requestFailed (err) {\n      this.isLoginError = true\n      this.$notification['error']({\n        message: '错误',\n        description: ((err.response || {}).data || {}).message || '请求出现错误，请稍后再试',\n        duration: 4\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n  .main{\n  }\n.user-layout-login {\n  label {\n    font-size: 14px;\n  }\n\n  .getCaptcha {\n    display: block;\n    width: 100%;\n    height: 40px;\n  }\n\n  .forge-password {\n    font-size: 14px;\n  }\n\n  button.login-button {\n    padding: 0 15px;\n    font-size: 16px;\n    height: 40px;\n    width: 100%;\n  }\n\n  .user-login-other {\n    text-align: left;\n    margin-top: 24px;\n    line-height: 22px;\n\n    .item-icon {\n      font-size: 24px;\n      color: rgba(0, 0, 0, 0.2);\n      margin-left: 16px;\n      vertical-align: middle;\n      cursor: pointer;\n      transition: color 0.3s;\n\n      &:hover {\n        color: #1890ff;\n      }\n    }\n\n    .register {\n      float: right;\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/views/user"}]}